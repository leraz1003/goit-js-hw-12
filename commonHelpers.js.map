{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-function.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["//  функції для відображення елементів інтерфейсу.\nconst gallery = document.querySelector(\".gallery\");\n\n\nexport default function createImageGallery(images) {\n  const markup = images.map(({ webformatURL, largeImageURL, tags,likes,views,comments,downloads }) =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n          </a>\n          <div class=\"gallery-info\">\n            <p class=\"info-item\">\n              <b>Likes</b> <span>${likes}</span>\n            </p>\n            <p class=\"info-item\">\n              <b>Views</b> <span>${views}</span>\n            </p>\n            <p class=\"info-item\">\n              <b>Comments</b> <span>${comments}</span>\n            </p>\n            <p class=\"info-item\">\n              <b>Downloads</b> <span>${downloads}</span>\n            </p>\n          </div>\n\n        </li>`)\n    .join(\"\");\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n\n  const newItem = gallery.querySelector('.gallery-item');\n\n  if (newItem) {\n    const rect = newItem.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: rect*2,\n      left: 0,\n      behavior: 'smooth'\n    });\n  }\n\n}","import axios from \"axios\";\nimport { showError } from \"../main\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\naxios.defaults.baseURL = BASE_URL;\n\nconst loader = document.querySelector('.loader');\n\nexport async function fetchRequest(queryValue, page = 1, per_page = 15) {\n\n  if (!queryValue) {\n    return [] ;\n  }\n\n  loader.classList.remove('hidden');\n\n  const searchParams = new URLSearchParams({\n    key: \"45116727-e543bef81ffe857c5144581e6\",\n    q: queryValue,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    page,\n    per_page\n  });\n\n\n  try {\n    const response = await axios.get(`?${searchParams}`);\n    return response.data;\n  } catch (error) {\n         showError(error);\n  } finally {\n    loader.classList.add('hidden');\n  }\n}\n\n\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n\nimport  createImageGallery  from './js/render-function.js';\nimport { fetchRequest } from './js/pixabay-api.js';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector(\".gallery\");\nconst loadBtn = document.querySelector(\".loadMoreBtn\");\nconst loader = document.querySelector('.loader');\n\nlet queryValue = '';\n\nexport function showError(errorMessage) {\n  iziToast.show({\n          message: errorMessage,\n          backgroundColor: \"#ef4040\",\n          position: \"topRight\",\n          messageSize: 16,\n          messageColor: '#fff',\n          messageLineHeight: \"150%\",\n\n          image: './img/error.svg',\n          imageWidth: 24,\n          timeout: 4000\n        });\n}\n\nclass ButtonService {\n  constructor(buttonEL, hiddenClass) {\n    this.buttonEL = buttonEL;\n    this.hiddenClass = hiddenClass;\n  }\n\n  hide() {\n    this.buttonEL.classList.add(this.hiddenClass);\n  }\n\n  show() {\n    this.buttonEL.classList.remove(this.hiddenClass);\n  }\n\n  disable() {\n    this.buttonEL.disabled = true;\n  }\n\n  enable() {\n    this.buttonEL.disabled = false;\n  }\n}\n\nconst loadMoreBtn = new ButtonService(loadBtn, \"is-hidden\");\n\nloadMoreBtn.hide();\n\nconst params = {\n  page: 1,\n  per_page: 15,\n  maxPage: 0\n}\n\n\nform.addEventListener('submit', async (event)=>{\n  event.preventDefault();\n\n  gallery.innerHTML = '';\n  queryValue = event.currentTarget.elements.search_query.value.trim().toLowerCase();\n  params.page = 1;\n\n\n  loader.classList.remove('hidden');\n\n\n  try {\n    const { hits, totalHits } = await fetchRequest(queryValue, params.page, params.per_page);\n\n    if (!hits || hits.length === 0) {\n      showError('Sorry, there are no images matching your search query. Please try again!');\n\n      loadMoreBtn.hide();\n\n      } else {\n      createImageGallery(hits);\n\n        initLightbox();\n        loadMoreBtn.show();\n        loadMoreBtn.enable();\n    }\n\n\n    params.maxPage = Math.ceil(totalHits / params.per_page);\n\n    console.log(\"maxPage\", params.maxPage);\n\n    if (params.maxPage > 1) {\n      loadMoreBtn.enable();\n      loadBtn.addEventListener(\"click\", handleLoadMore);\n    } else {\n      loadMoreBtn.hide();\n    }\n  }\n  catch (error) {\n    showError(error);\n  }\n  finally {\n    loader.classList.add('hidden');\n  }\n  form.reset();\n});\n\nasync function handleLoadMore() {\n  loader.classList.remove('hidden');\n  loadMoreBtn.hide();\n  // loadMoreBtn.disable();\n\n  params.page += 1;\n\n  try {\n    const { hits } = await fetchRequest(queryValue, params.page, params.per_page);\n    createImageGallery(hits);\n    loadMoreBtn.show();\n\n  } catch (error) {\n     showError(error);\n  } finally {\n    if (params.page === params.maxPage) {\n      loadMoreBtn.hide();\n      showError(\"We're sorry, but you've reached the end of search results.\");\n      loadBtn.removeEventListener(\"click\", handleLoadMore);\n    } else {\n      loadMoreBtn.enable();\n    }\n    loader.classList.add('hidden');\n  }\n}\n\n\n\nexport function initLightbox() {\n    const lightbox = new SimpleLightbox('.gallery a', {\n        captions: true,\n        captionSelector: 'img',\n        captionsData: 'alt',\n        captionPosition: 'bottom',\n        captionDelay: 250\n    });\n    lightbox.refresh();\n}"],"names":["gallery","createImageGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","newItem","rect","BASE_URL","axios","loader","fetchRequest","queryValue","page","per_page","searchParams","error","showError","form","loadBtn","errorMessage","iziToast","ButtonService","buttonEL","hiddenClass","loadMoreBtn","params","event","hits","totalHits","initLightbox","handleLoadMore","SimpleLightbox"],"mappings":"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"}